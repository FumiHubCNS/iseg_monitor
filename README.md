# Iseg Monitor

京都大学の矢野くんが作ってくれたiseg iCS2ロガー。

オリジナルのリポジトリは`poetry`で管理されているが、ここでは`uv`で使えるようにしている。

## 整備

pythonとuvは入ってるものとして、クローンしたア後に以下のコマンドを実行する。

```zsh
uv sync
```

これで実行環境は整う。

## iCSおよび検出器の設定

ロガーを実行する前に、読み込む電圧を制御しているiCSの情報と検出器の情報が必要。
まずはiCSについてだが、これは`src/iseg_monitor/conf/.env`に書き込む。
書き方は同じディレクトリにある`.env.example`をみながら書けるはず。
変数から何をかくべきかは想像できるので、書き方は省略。

次に検出器の情報だが、`src/iseg_monitor/conf/detectors.json`に書き込む。
これも`src/iseg_monitor/conf/detectors.example.json`を参考にすれば簡単に書けるはず。

## 実行コマンド

上記のように整備ができたら以下のコマンドでデータのストアを解析できる。

```zsh
uv run start-logger
```

ユーザーとしてはdbがどのような構造をしているか、どんな感じで保存されたかを確認したくなる。
以下のコマンドでdbの中身を確認できる。

```zsh
uv run db-check 
```

このコマンドに関してはいくつか引数を指定できる。
以下で引数を確認できる。

```zsh
uv run db-check -h
```

よく使う引数は`-n`、`-f`、`-d`だと思う。

- `-n`はダンプする行数。このスクリプトではdbファイルを下からこの引数で指定した分だけダンプします。
- `-f`は描画するコマンド。読み込んだデータをそのまま描画します。
- `-d`は描画に際して、データのダウンサンプリング数を指定します。この描画オプションでは`plotly`を使用しており、データ点が多いと劇重になる。